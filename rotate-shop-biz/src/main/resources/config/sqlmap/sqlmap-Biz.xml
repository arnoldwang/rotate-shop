<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">
<sqlMap namespace="Biz">
    <typeAlias alias="Biz" type="com.dianping.rotate.shop.entity.BizEntity" />
    <resultMap id="biz" class="Biz">
        <result property="id" column="ID"/>
        <result property="bizID" column="BizID"/>
        <result property="name" column="Name"/>
        <result property="business" column="Business"/>
        <result property="status" column="Status"/>
        <result property="createdTime" column="CreatedTime"/>
        <result property="lastModifiedTime" column="LastModifiedTime"/>
    </resultMap>

    <sql id="keys">
        BizID,
        Name,
        Business,
        Status,
        CreatedTime,
        LastModifiedTime
    </sql>

    <sql id="key-value">
        (
        <include refid="keys"/>
        )
        VALUES
        (
        #biz.bizID#,
        #biz.name#,
        #biz.business#,
        #biz.status#,
        NOW(),
        NOW()
        )
    </sql>

    <sql id="modify">
        SET
            BizID = #biz.bizID#,
            Name = #biz.name#,
            Business = #biz.business#,
            Status = #biz.status#,
            LastModifiedTime = NOW()
        WHERE BizID = #biz.bizID#
    </sql>

    <insert id="addToBiz" parameterClass="map">
        INSERT INTO Biz
        <include refid="key-value"/>
    </insert>

    <delete id="deleteBiz" parameterClass="map">
        UPDATE Biz
        SET
            Status = 0,
            LastModifiedTime = NOW()
        WHERE BizID = #bizID#
    </delete>

    <update id="updateBiz" parameterClass="map">
        UPDATE Biz
        <include refid="modify"/>
    </update>

    <select id="queryBiz" resultMap="biz" parameterClass="map">
        SELECT ID,
        <include refid="keys"/>
        FROM Biz
        WHERE BizID = #bizID#
    </select>
</sqlMap>